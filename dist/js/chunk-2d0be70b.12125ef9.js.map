{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?59b5"],"names":["for","class","onSubmit","pError","type","id","email","eBlur","eError","password","pBlur","disabled","isSubmitting","isTooManyAttempts","loading","useLoginForm","ref","store","useStore","router","useRouter","useForm","handleSubmit","submitCount","useField","yup","trim","required","value","errorMessage","handleBlur","MIN_LENGTH","min","computed","watch","val","setTimeout","values","dispatch","push","console","log","setup","route","query","message","error","__exports__","render"],"mappings":"2IAEI,eAAwB,UAApB,mBAAe,G,EAGjB,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAMxB,eAAoC,SAA7BA,IAAI,YAAW,UAAM,G,2BAS7B,W,mBAIIC,MAAM,e,EAKb,eAGM,OAHDA,MAAM,QAAM,CACf,eAAwB,SAArB,qBACH,eAAsB,SAAnB,qB,+EA9BL,eA0BO,QA1BDA,MAAM,OAAQ,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CAC1C,EAEA,eAIM,OAJAD,MAAK,yBAA8B,EAAAE,U,CACvC,E,eACA,eAA+D,SAAxDC,KAAK,QAAQC,GAAG,Q,qDAAiB,EAAAC,MAAK,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAd,EAAAD,SAC3B,EAAAE,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAIM,OAJAP,MAAK,yBAA8B,EAAAE,U,CACvC,E,eACA,eAAwE,SAAjEC,KAAK,WAAWC,GAAG,W,qDAAoB,EAAAI,SAAQ,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAjB,EAAAD,YACjC,EAAAD,Q,iBAAb,eAAyC,yBAAjB,EAAAL,QAAM,I,0BAGhC,eAOS,UANPF,MAAM,cACNG,KAAK,SACJO,SAAU,EAAAC,cAAgB,EAAAC,mB,GAGf,EAAAC,S,iBAAZ,eAAuC,SAAlB,gB,uCAEQ,EAAAD,mB,iBAA/B,eAEM,MAFN,EAAkD,oE,2BAKpD,G,gHCvBK,SAASE,IACd,IAAMD,EAAUE,gBAAI,GACdC,EAAQC,iBACRC,EAASC,iBAHc,EAIuBC,iBAA5CC,EAJqB,EAIrBA,aAAcV,EAJO,EAIPA,aAAcW,EAJP,EAIOA,YAJP,EAMqCC,eAChE,QACAC,SAEGC,OACAC,SAAS,4BACTrB,MAAM,uCANIA,EANc,EAMrBsB,MAA4BpB,EANP,EAMPqB,aAAkCtB,EAN3B,EAMeuB,WAStCC,EAAa,EAfU,EAiBwCP,eACnE,WACAC,SAEGC,OACAC,SAAS,6BACTK,IAAID,EAJP,sCAIkDA,EAJlD,eAFatB,EAjBc,EAiBrBmB,MAA+BzB,EAjBV,EAiBJ0B,aAAkCnB,EAjB9B,EAiBkBoB,WASzCjB,EAAoBoB,gBAAS,kBAAMV,EAAYK,OAAS,KAE9DM,eAAMrB,GAAmB,SAACsB,GACpBA,GACFC,YAAW,WACTb,EAAYK,MAAQ,IACnB,QAIP,IAAM1B,EAAWoB,EAAY,yDAAC,WAAOe,GAAP,iGAE1BvB,EAAQc,OAAQ,EAFU,SAGpBX,EAAMqB,SAAS,aAAcD,GAHT,OAI1BvB,EAAQc,OAAQ,EAChBT,EAAOoB,KAAK,KALc,mDAO1BzB,EAAQc,OAAQ,EAChBY,QAAQC,IAAI,cARc,yDAAD,uDAY7B,MAAO,CACLnC,QACAJ,WACAU,eACAJ,SACAD,QACAM,oBACAJ,WACAN,SACAO,QACAI,W,gBDvBW,GACb4B,MADa,WAEX,IAAMC,EAAQ,iBACR1B,EAAQ,iBASd,OAPI0B,EAAMC,MAAMC,SACd5B,EAAMqB,SAAS,aAAc,CAC3BV,MAAO,OAAAkB,EAAA,MAAMH,EAAMC,MAAMC,SACzBzC,KAAM,YAIV,kBACKW,O,qBEjDT,MAAMgC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d0be70b.12125ef9.js","sourcesContent":["<template>\r\n  <form class=\"card\" @submit.prevent=\"onSubmit\">\r\n    <h1>Войти в систему</h1>\r\n\r\n    <div :class=\"['form-control', { invalid: pError }]\">\r\n      <label for=\"email\">Email</label>\r\n      <input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\" />\r\n      <small v-if=\"eError\">{{ eError }}</small>\r\n    </div>\r\n\r\n    <div :class=\"['form-control', { invalid: pError }]\">\r\n      <label for=\"password\">Пароль</label>\r\n      <input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\" />\r\n      <small v-if=\"eError\">{{ pError }}</small>\r\n    </div>\r\n\r\n    <button\r\n      class=\"btn primary\"\r\n      type=\"submit\"\r\n      :disabled=\"isSubmitting || isTooManyAttempts\"\r\n    >\r\n      Войти\r\n      <span v-if=\"loading\">Загрузка...</span>\r\n    </button>\r\n    <div class=\"text-danger\" v-if=\"isTooManyAttempts\">\r\n      Вы слишком частов пытаетесь войти в систему. Попробуйте позже\r\n    </div>\r\n  </form>\r\n\r\n  <div class=\"card\">\r\n    <p>Логин - v@mail.ru</p>\r\n    <p>Пароль - 123456</p>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from \"vue-router\";\r\nimport { useStore } from \"vuex\";\r\nimport { useLoginForm } from \"../use/login-form\";\r\nimport { error } from \"../utils/error\";\r\n\r\nexport default {\r\n  setup() {\r\n    const route = useRoute();\r\n    const store = useStore();\r\n\r\n    if (route.query.message) {\r\n      store.dispatch(\"setMessage\", {\r\n        value: error(route.query.message),\r\n        type: \"warning\",\r\n      });\r\n    }\r\n\r\n    return {\r\n      ...useLoginForm(),\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style></style>\r\n","import { computed, watch, ref } from \"vue\";\r\nimport * as yup from \"yup\";\r\nimport { useField, useForm } from \"vee-validate\";\r\nimport { useStore } from \"vuex\";\r\nimport { useRouter } from \"vue-router\";\r\n\r\nexport function useLoginForm() {\r\n  const loading = ref(false);\r\n  const store = useStore();\r\n  const router = useRouter();\r\n  const { handleSubmit, isSubmitting, submitCount } = useForm();\r\n\r\n  const { value: email, errorMessage: eError, handleBlur: eBlur } = useField(\r\n    \"email\",\r\n    yup\r\n      .string()\r\n      .trim()\r\n      .required(\"Пожалуйста введите емайл\")\r\n      .email(\"Необходимо ввести корректный email\")\r\n  );\r\n\r\n  const MIN_LENGTH = 6;\r\n\r\n  const { value: password, errorMessage: pError, handleBlur: pBlur } = useField(\r\n    \"password\",\r\n    yup\r\n      .string()\r\n      .trim()\r\n      .required(\"Пожалуйста введите пароль\")\r\n      .min(MIN_LENGTH, `Пароль не может быть меньше ${MIN_LENGTH} символов`)\r\n  );\r\n\r\n  const isTooManyAttempts = computed(() => submitCount.value >= 3);\r\n\r\n  watch(isTooManyAttempts, (val) => {\r\n    if (val) {\r\n      setTimeout(() => {\r\n        submitCount.value = 0;\r\n      }, 2000);\r\n    }\r\n  });\r\n\r\n  const onSubmit = handleSubmit(async (values) => {\r\n    try {\r\n      loading.value = true;\r\n      await store.dispatch(\"auth/login\", values);\r\n      loading.value = false;\r\n      router.push(\"/\");\r\n    } catch (e) {\r\n      loading.value = false;\r\n      console.log('Ошибкааааа');\r\n    }\r\n  });\r\n\r\n  return {\r\n    email,\r\n    onSubmit,\r\n    isSubmitting,\r\n    eError,\r\n    eBlur,\r\n    isTooManyAttempts,\r\n    password,\r\n    pError,\r\n    pBlur,\r\n    loading,\r\n  };\r\n}\r\n","import { render } from \"./Auth.vue?vue&type=template&id=1a1229ee\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\Study\\\\Vue\\\\vue-portfolio\\\\tinkof\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}